<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    
    <!-- Core Web Vitals & Performance Optimization -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="format-detection" content="telephone=no" />
    
    <!-- Critical Resource Hints - Only preload critical resources -->
    <link rel="dns-prefetch" href="//api.phimgg.com" />
    
    <!-- Optimized title under 580 pixels (about 60 characters) -->
    <title>PhimGG - Free HD Movies & TV Shows Online</title>
    <!-- Optimized description under 1000 pixels (about 155 characters) -->
    <meta name="description" content="Stream thousands of HD movies and TV shows free. Latest releases, classics, and exclusive content. Watch now on PhimGG.com" />
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
    <meta name="keywords" content="watch movies online, HD movies, latest movies, movie series, cinema online, free movies, PhimGG" />
    <meta name="author" content="PhimGG" />
    
    <!-- Enhanced SEO Meta Tags -->
    <meta name="language" content="en" />
    <meta name="rating" content="General" />
    <meta name="distribution" content="Global" />
    <meta name="revisit-after" content="1 days" />
    <meta name="geo.region" content="US" />
    <meta name="geo.placename" content="United States" />
    <link rel="canonical" href="https://phimgg.com/" />
    
    <!-- Enhanced Favicon Support -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="theme-color" content="#3b82f6" />
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="PhimGG - Free HD Movies & TV Shows Online" />
    <meta property="og:description" content="Stream thousands of HD movies and TV shows free. Latest releases, classics, and exclusive content. Watch now on PhimGG.com" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://phimgg.com" />
    <meta property="og:site_name" content="PhimGG" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:image" content="https://phimgg.com/og-image.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:type" content="image/jpeg" />
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="PhimGG - Free HD Movies & TV Shows Online" />
    <meta name="twitter:description" content="Stream thousands of HD movies and TV shows free. Latest releases, classics, and exclusive content. Watch now on PhimGG.com" />
    <meta name="twitter:site" content="@PhimGG" />
    <meta name="twitter:creator" content="@PhimGG" />
    <meta name="twitter:image" content="https://phimgg.com/twitter-image.jpg" />
    
    <!-- Additional Schema.org Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "PhimGG",
      "alternateName": "PhimGG Movie Streaming",
      "url": "https://phimgg.com",
      "description": "Stream thousands of HD movies and TV shows free. Latest releases, classics, and exclusive content available now.",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://phimgg.com/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      },
      "publisher": {
        "@type": "Organization",
        "name": "PhimGG",
        "url": "https://phimgg.com",
        "logo": {
          "@type": "ImageObject",
          "url": "https://phimgg.com/logo.png",
          "width": 512,
          "height": 512
        },
        "contactPoint": {
          "@type": "ContactPoint",
          "telephone": "+1-555-PHIMGG",
          "contactType": "customer service",
          "availableLanguage": ["English"]
        }
      },
      "sameAs": [
        "https://twitter.com/PhimGG",
        "https://facebook.com/PhimGG",
        "https://instagram.com/PhimGG"
      ]
    }
    </script>
    
    <!-- Organization Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "PhimGG",
      "url": "https://phimgg.com",
      "logo": "https://phimgg.com/logo.png",
      "description": "Leading free streaming platform for movies and TV shows",
      "foundingDate": "2024",
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+1-555-PHIMGG",
        "contactType": "customer service"
      },
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "US"
      }
    }
    </script>
    
    <!-- Breadcrumb Schema for Homepage -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://phimgg.com"
      }]
    }
    </script>
    
    <!-- Enhanced Performance & Security Headers with Improved CSP -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' 
        https://cdn.jsdelivr.net 
        https://unpkg.com 
        https://player.phimapi.com 
        https://*.phim1280.tv 
        https://*.phimapi.com 
        https://pagead2.googlesyndication.com
        https://googletagmanager.com
        https://www.google-analytics.com
        https://connect.facebook.net
        https://apis.google.com
        https://*.google.com
        https://ep2.adtrafficquality.google
        https://adservice.google.com
        https://www.googleadservices.com;
      style-src 'self' 'unsafe-inline' 
        https://fonts.googleapis.com 
        https://cdn.jsdelivr.net
        https://unpkg.com;
      font-src 'self' 
        https://fonts.gstatic.com 
        https://cdn.jsdelivr.net
        data:;
      img-src 'self' data: https: blob:
        https://*.phim1280.tv
        https://*.phimapi.com
        https://img.phimapi.com
        https://image.tmdb.org
        https://*.googleusercontent.com
        https://pagead2.googlesyndication.com;
      connect-src 'self' 
        https://api.phimgg.com 
        https: wss: ws: 
        https://*.phim1280.tv 
        https://*.phimapi.com 
        https://pagead2.googlesyndication.com
        https://www.google-analytics.com
        https://analytics.google.com
        https://graph.facebook.com
        https://api.themoviedb.org;
      media-src 'self' https: blob: data: 
        https://*.phim1280.tv 
        https://*.phimapi.com
        https://*.kkphimplayer6.com
        https://*.cloudfront.net;
      frame-src 'self' https: http: data: blob: 
        https://player.phimapi.com 
        https://*.phim1280.tv 
        https://*.phimapi.com 
        https://pagead2.googlesyndication.com
        https://www.facebook.com
        https://accounts.google.com;
      child-src 'self' https: http: data: blob: 
        https://player.phimapi.com 
        https://*.phim1280.tv 
        https://*.phimapi.com 
        https://pagead2.googlesyndication.com;
      object-src 'none';
      base-uri 'self';
      form-action 'self' 
        https://accounts.google.com 
        https://www.facebook.com;
      frame-ancestors 'none';
      upgrade-insecure-requests;
    " />
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />
    <meta http-equiv="Permissions-Policy" content="
      geolocation=(), 
      microphone=(), 
      camera=(), 
      payment=(),
      usb=(),
      magnetometer=(),
      gyroscope=(),
      accelerometer=(),
      ambient-light-sensor=(),
      autoplay=(self),
      encrypted-media=(self),
      fullscreen=(self),
      picture-in-picture=(self)
    " />
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="X-Frame-Options" content="DENY" />
    <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
    
    <!-- Performance Optimization Headers -->
    <meta http-equiv="Cache-Control" content="public, max-age=3600, stale-while-revalidate=86400" />
    <meta name="format-detection" content="telephone=no, date=no, email=no, address=no" />
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6124954442503878"
            crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Service Worker Registration for PWA with proper update handling -->
    <script>
      // Enhanced Service Worker registration with comprehensive debugging
      const DEBUG_MODE = localStorage.getItem('filmflex-debug') === 'true';
      
      const debugLog = (message, data) => {
        if (DEBUG_MODE) {
          console.log(`ðŸ” SW Debug: ${message}`, data || '');
        }
      };
      
      // Immediately clear problematic caches on page load
      if ('caches' in window) {
        caches.keys().then(cacheNames => {
          const oldCaches = cacheNames.filter(name => 
            name.includes('phimgg-v1') || 
            name.includes('filmflex-v1') || 
            name.includes('filmflex-v2') ||
            !name.includes(Date.now().toString().slice(0, 8)) // Clear caches older than today
          );
          
          if (oldCaches.length > 0) {
            console.log('ðŸ§¹ Clearing old problematic caches:', oldCaches);
            return Promise.all(oldCaches.map(name => caches.delete(name)));
          }
        }).then(() => {
          debugLog('Old caches cleared');
        }).catch(err => {
          console.error('Failed to clear old caches:', err);
        });
      }

      if ('serviceWorker' in navigator) {
        // Enhanced registration with immediate update handling
        navigator.serviceWorker.register('/sw.js', {
          updateViaCache: 'none' // Always check for SW updates
        }).then((registration) => {
          console.log('âœ… SW registered:', registration.scope);
          
          // Force update check immediately
          registration.update();
          
          // Handle updates more aggressively
          registration.addEventListener('updatefound', () => {
            const newWorker = registration.installing;
            console.log('ðŸ”„ New SW version found, installing...');
            
            if (newWorker) {
              newWorker.addEventListener('statechange', () => {
                console.log('SW state changed to:', newWorker.state);
                
                if (newWorker.state === 'installed') {
                  if (navigator.serviceWorker.controller) {
                    console.log('ðŸš€ New SW installed, forcing activation...');
                    newWorker.postMessage({ type: 'SKIP_WAITING' });
                  } else {
                    console.log('âœ… SW installed for first time');
                  }
                }
              });
            }
          });
          
          // Enhanced controller change handling
          navigator.serviceWorker.addEventListener('controllerchange', () => {
            console.log('ðŸ”„ SW controller changed - reloading page...');
            window.location.reload();
          });
          
          // Listen for messages from SW
          navigator.serviceWorker.addEventListener('message', (event) => {
            const { data } = event;
            console.log('ðŸ“¨ Message from SW:', data);
            
            if (data.type === 'SW_ACTIVATED') {
              console.log('âœ… New SW activated:', data.message);
            }
          });
          
        }).catch((error) => {
          console.error('âŒ SW registration failed:', error);
        });
      }
      
      // Enhanced cache management utilities with performance monitoring
      window.filmflexCache = {
        // Performance metrics tracking
        _metrics: {
          cacheHits: 0,
          cacheMisses: 0,
          lastCleared: null,
          totalCacheSize: 0,
          performanceData: []
        },

        // Clear all caches and reload with detailed logging
        clearAll: async () => {
          console.log('ðŸ§¹ Clearing all caches...');
          const startTime = performance.now();
          try {
            // Clear caches
            if ('caches' in window) {
              const cacheNames = await caches.keys();
              console.log('Found caches:', cacheNames);
              
              // Get cache sizes before clearing
              let totalSize = 0;
              for (const name of cacheNames) {
                const cache = await caches.open(name);
                const keys = await cache.keys();
                totalSize += keys.length;
              }
              
              await Promise.all(cacheNames.map(name => caches.delete(name)));
              console.log(`ðŸ—‘ï¸ Cleared ${cacheNames.length} caches with ${totalSize} items`);
            }
            
            // Unregister all service workers
            if ('serviceWorker' in navigator) {
              const registrations = await navigator.serviceWorker.getRegistrations();
              await Promise.all(registrations.map(reg => reg.unregister()));
              console.log(`ðŸ”„ Unregistered ${registrations.length} service workers`);
            }
            
            // Clear storage with size tracking
            const localStorageSize = Object.keys(localStorage).length;
            const sessionStorageSize = Object.keys(sessionStorage).length;
            localStorage.clear();
            sessionStorage.clear();
            
            const endTime = performance.now();
            const clearTime = endTime - startTime;
            
            // Update metrics
            this._metrics.lastCleared = new Date().toISOString();
            this._metrics.totalCacheSize = 0;
            
            console.log(`âœ… Cache clear completed in ${clearTime.toFixed(2)}ms`);
            console.log(`ðŸ“Š Cleared ${localStorageSize} localStorage items, ${sessionStorageSize} sessionStorage items`);
            
            // Store performance data
            const performanceEntry = {
              timestamp: new Date().toISOString(),
              operation: 'clearAll',
              duration: clearTime,
              itemsCleared: totalSize + localStorageSize + sessionStorageSize
            };
            
            // Save to sessionStorage for this session
            try {
              sessionStorage.setItem('filmflex-last-clear', JSON.stringify(performanceEntry));
            } catch (e) {
              console.warn('Could not save performance data:', e);
            }
            
            window.location.reload();
          } catch (error) {
            console.error('âŒ Failed to clear caches:', error);
            window.location.reload();
          }
        },
        
        // Get comprehensive cache information and performance metrics
        info: async () => {
          console.log('ðŸ“Š FilmFlex Cache Performance Report');
          console.log('=====================================');
          
          const report = {
            timestamp: new Date().toISOString(),
            caches: [],
            storage: {},
            performance: {},
            metrics: this._metrics
          };

          // Cache information
          if ('caches' in window) {
            const cacheNames = await caches.keys();
            let totalCacheItems = 0;
            let totalCacheSize = 0;
            
            const cacheInfo = await Promise.all(
              cacheNames.map(async (name) => {
                const cache = await caches.open(name);
                const keys = await cache.keys();
                const urls = keys.map(req => req.url);
                
                // Estimate cache size (rough calculation)
                let estimatedSize = 0;
                for (const url of urls.slice(0, 10)) { // Sample first 10 URLs
                  try {
                    const response = await cache.match(url);
                    if (response && response.headers.get('content-length')) {
                      estimatedSize += parseInt(response.headers.get('content-length'));
                    }
                  } catch (e) {
                    // Ignore errors for size estimation
                  }
                }
                
                totalCacheItems += keys.length;
                totalCacheSize += estimatedSize;
                
                return {
                  name,
                  itemCount: keys.length,
                  estimatedSizeKB: Math.round(estimatedSize / 1024),
                  sampleUrls: urls.slice(0, 3),
                  createdAt: name.includes('v') ? name.split('v')[1] : 'unknown'
                };
              })
            );
            
            report.caches = cacheInfo;
            this._metrics.totalCacheSize = totalCacheSize;
            
            console.log(`ðŸ—„ï¸ Total Caches: ${cacheNames.length}`);
            console.log(`ðŸ“¦ Total Cached Items: ${totalCacheItems}`);
            console.log(`ðŸ’¾ Estimated Cache Size: ${Math.round(totalCacheSize / 1024)} KB`);
            console.table(cacheInfo);
          }

          // Storage information
          const storageInfo = {
            localStorage: {
              itemCount: Object.keys(localStorage).length,
              estimatedSizeKB: Math.round(JSON.stringify(localStorage).length / 1024),
              keys: Object.keys(localStorage).slice(0, 10)
            },
            sessionStorage: {
              itemCount: Object.keys(sessionStorage).length,
              estimatedSizeKB: Math.round(JSON.stringify(sessionStorage).length / 1024),
              keys: Object.keys(sessionStorage).slice(0, 10)
            }
          };
          
          report.storage = storageInfo;
          console.log('ðŸ—ƒï¸ Storage Information:');
          console.table(storageInfo);

          // Performance information
          const performanceInfo = {
            navigation: performance.getEntriesByType('navigation')[0],
            memory: performance.memory ? {
              usedJSHeapSize: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024) + ' MB',
              totalJSHeapSize: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024) + ' MB',
              jsHeapSizeLimit: Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024) + ' MB'
            } : 'Not available',
            lastClearTime: this._metrics.lastCleared,
            cacheHitRate: this._metrics.cacheHits + this._metrics.cacheMisses > 0 
              ? ((this._metrics.cacheHits / (this._metrics.cacheHits + this._metrics.cacheMisses)) * 100).toFixed(2) + '%'
              : 'No data'
          };
          
          report.performance = performanceInfo;
          console.log('âš¡ Performance Metrics:');
          console.log(performanceInfo);

          // Service Worker status
          if ('serviceWorker' in navigator) {
            const registration = await navigator.serviceWorker.getRegistration();
            const swInfo = {
              registered: !!registration,
              active: registration?.active?.state || 'none',
              waiting: registration?.waiting?.state || 'none',
              installing: registration?.installing?.state || 'none'
            };
            
            report.serviceWorker = swInfo;
            console.log('ðŸ”§ Service Worker Status:');
            console.log(swInfo);
          }

          // Connection information
          if ('connection' in navigator) {
            const connectionInfo = {
              effectiveType: navigator.connection.effectiveType,
              downlink: navigator.connection.downlink + ' Mbps',
              rtt: navigator.connection.rtt + ' ms',
              saveData: navigator.connection.saveData
            };
            
            report.connection = connectionInfo;
            console.log('ðŸŒ Network Information:');
            console.log(connectionInfo);
          }

          console.log('=====================================');
          console.log('ðŸ’¡ Commands: clearAll(), forceUpdate(), enableDebug(), trackMetrics()');
          
          return report;
        },
        
        // Force SW update with performance tracking
        forceUpdate: async () => {
          const startTime = performance.now();
          if ('serviceWorker' in navigator) {
            const registration = await navigator.serviceWorker.getRegistration();
            if (registration) {
              console.log('ðŸ”„ Forcing SW update...');
              await registration.update();
              const endTime = performance.now();
              console.log(`âœ… SW update triggered in ${(endTime - startTime).toFixed(2)}ms`);
              
              // Track metrics
              this._metrics.performanceData.push({
                operation: 'forceUpdate',
                duration: endTime - startTime,
                timestamp: new Date().toISOString()
              });
            } else {
              console.log('âŒ No service worker registration found');
            }
          }
        },
        
        // Enable debug mode with enhanced logging
        enableDebug: () => {
          localStorage.setItem('filmflex-debug', 'true');
          localStorage.setItem('filmflex-debug-level', 'verbose');
          console.log('ðŸ”§ Enhanced debug mode enabled - reload to see verbose debug logs');
          console.log('ðŸ” Debug features: SW lifecycle, cache operations, performance tracking');
        },
        
        // Disable debug mode
        disableDebug: () => {
          localStorage.removeItem('filmflex-debug');
          localStorage.removeItem('filmflex-debug-level');
          console.log('ðŸ”§ Debug mode disabled');
        },

        // Track cache hit/miss metrics
        trackMetrics: (hit = true) => {
          if (hit) {
            this._metrics.cacheHits++;
          } else {
            this._metrics.cacheMisses++;
          }
        },

        // Get performance summary
        getPerformanceSummary: () => {
          const summary = {
            cacheHitRate: this._metrics.cacheHits + this._metrics.cacheMisses > 0 
              ? ((this._metrics.cacheHits / (this._metrics.cacheHits + this._metrics.cacheMisses)) * 100).toFixed(2) + '%'
              : 'No data',
            totalOperations: this._metrics.performanceData.length,
            averageOperationTime: this._metrics.performanceData.length > 0
              ? (this._metrics.performanceData.reduce((sum, op) => sum + op.duration, 0) / this._metrics.performanceData.length).toFixed(2) + 'ms'
              : 'No data',
            lastCleared: this._metrics.lastCleared || 'Never',
            estimatedCacheSize: Math.round(this._metrics.totalCacheSize / 1024) + ' KB'
          };
          
          console.log('ðŸ“ˆ Performance Summary:');
          console.table(summary);
          return summary;
        },

        // Monitor real-time performance
        startPerformanceMonitoring: () => {
          if (this._performanceMonitor) {
            console.log('âš ï¸ Performance monitoring already running');
            return;
          }

          console.log('ðŸš€ Starting real-time performance monitoring...');
          
          this._performanceMonitor = setInterval(() => {
            const now = performance.now();
            const memory = performance.memory;
            
            if (memory) {
              const memoryUsage = Math.round(memory.usedJSHeapSize / 1024 / 1024);
              const memoryLimit = Math.round(memory.jsHeapSizeLimit / 1024 / 1024);
              const memoryPercent = ((memoryUsage / memoryLimit) * 100).toFixed(1);
              
              // Log only if memory usage is high
              if (memoryPercent > 75) {
                console.warn(`âš ï¸ High memory usage: ${memoryUsage}MB (${memoryPercent}%)`);
              }
            }
            
            // Check for slow operations
            const recentOps = this._metrics.performanceData.slice(-10);
            const slowOps = recentOps.filter(op => op.duration > 1000);
            
            if (slowOps.length > 0) {
              console.warn(`ðŸŒ Detected ${slowOps.length} slow operations in last 10 operations`);
            }
          }, 30000); // Check every 30 seconds

          console.log('âœ… Performance monitoring started (30s intervals)');
        },

        // Stop performance monitoring
        stopPerformanceMonitoring: () => {
          if (this._performanceMonitor) {
            clearInterval(this._performanceMonitor);
            this._performanceMonitor = null;
            console.log('â¹ï¸ Performance monitoring stopped');
          } else {
            console.log('â„¹ï¸ Performance monitoring was not running');
          }
        }
      };
      
      // Auto-detect and fix blank page issues
      setTimeout(() => {
        const rootElement = document.getElementById('root');
        if (rootElement && (!rootElement.innerHTML || rootElement.innerHTML.trim() === '')) {
          console.error('ðŸš¨ BLANK PAGE DETECTED! Root element is empty after 3 seconds');
          console.error('ðŸ”§ Attempting automatic fixes...');
          
          // Show temporary loading message
          rootElement.innerHTML = `
            <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; background: #1a1a2e; color: white; font-family: Arial, sans-serif;">
              <div style="text-align: center; padding: 20px;">
                <div style="font-size: 24px; margin-bottom: 20px;">ðŸ”„ Fixing Loading Issue...</div>
                <div style="margin-bottom: 20px;">Please wait while we resolve the blank page problem.</div>
                <button onclick="filmflexCache.clearAll()" style="background: #3b82f6; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px;">
                  Clear Cache & Reload
                </button>
                <button onclick="location.reload()" style="background: #10b981; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px;">
                  Simple Reload
                </button>
              </div>
            </div>
          `;
          
          // Try automatic cache clear after 2 seconds
          setTimeout(() => {
            console.log('ðŸ”§ Auto-clearing caches due to blank page...');
            filmflexCache.clearAll();
          }, 2000);
        }
      }, 3000);
      
      // Auto-clear cache on version mismatch (enhanced)
      const APP_VERSION = '2025061503'; // Update this with each deployment
      const storedVersion = localStorage.getItem('filmflex-version');
      
      if (storedVersion && storedVersion !== APP_VERSION) {
        console.log(`ðŸ”„ Version mismatch: ${storedVersion} -> ${APP_VERSION}`);
        console.log('ðŸ§¹ Clearing caches for new version...');
        
        if ('caches' in window) {
          caches.keys().then(cacheNames => {
            return Promise.all(cacheNames.map(name => caches.delete(name)));
          }).then(() => {
            localStorage.setItem('filmflex-version', APP_VERSION);
            console.log('âœ… Caches cleared for version update');
          });
        } else {
          localStorage.setItem('filmflex-version', APP_VERSION);
        }
      } else if (!storedVersion) {
        localStorage.setItem('filmflex-version', APP_VERSION);
        console.log('âœ… Version tracking initialized');
      }
      
      // Global error handlers for better debugging
      window.addEventListener('error', (event) => {
        console.error('ðŸš¨ Global Error:', {
          message: event.message,
          filename: event.filename,
          lineno: event.lineno,
          colno: event.colno,
          error: event.error
        });
        
        // If it's a loading error, try cache clear
        if (event.message.includes('Loading') || event.message.includes('import')) {
          console.log('ðŸ”§ Loading error detected, clearing caches in 5 seconds...');
          setTimeout(() => filmflexCache.clearAll(), 5000);
        }
      });
      
      window.addEventListener('unhandledrejection', (event) => {
        console.error('ðŸš¨ Unhandled Promise Rejection:', event.reason);
      });
      
      console.log('ðŸ”§ Enhanced cache management loaded. Use filmflexCache.info() to see cache status');
      console.log('ðŸ”§ Available commands: filmflexCache.clearAll(), filmflexCache.forceUpdate(), filmflexCache.enableDebug()');
    </script>
  </body>
</html>