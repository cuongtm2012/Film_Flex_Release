# ============================================
# PhimGG Production Environment Configuration
# ============================================
# Server: 38.54.14.154
# Domain: phimgg.com
# Last Updated: 2026-01-23
# ============================================

# Application Environment
NODE_ENV=production
PORT=5000

# ============================================
# Database Configuration
# ============================================
# PostgreSQL Database (Docker Container)
DATABASE_URL=postgresql://filmflex:filmflex2024@postgres:5432/filmflex

# For external connections (from host machine)
# DATABASE_URL=postgresql://filmflex:filmflex2024@localhost:5432/filmflex

# ============================================
# Server & Domain Configuration
# ============================================
# Production Server IP
SERVER_IP=38.54.14.154
DOMAIN=phimgg.com

# Public URLs
PUBLIC_URL=https://phimgg.com
CLIENT_URL=https://phimgg.com

# Alternative access (direct IP)
# PUBLIC_URL=http://38.54.14.154:5000
# CLIENT_URL=http://38.54.14.154:5000

# ============================================
# CORS Configuration
# ============================================
# Allow all origins for maximum compatibility
ALLOWED_ORIGINS=*
CORS_ORIGIN=*
CORS_METHODS=GET,HEAD,PUT,PATCH,POST,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Origin,X-Requested-With,Content-Type,Accept,Authorization,Cache-Control,Pragma
CORS_CREDENTIALS=true

# ============================================
# Security Configuration
# ============================================
# IMPORTANT: Change this to a strong random secret in production!
SESSION_SECRET=filmflex_production_secret_2024_phimgg_secure_key_change_this

# Encryption key for OAuth credentials
# IMPORTANT: Generate a strong random key for production
ENCRYPTION_KEY=your_production_encryption_key_here_change_this

# ============================================
# Elasticsearch Configuration
# ============================================
ELASTICSEARCH_NODE=http://filmflex-elasticsearch:9200
ELASTICSEARCH_URL=http://filmflex-elasticsearch:9200
ELASTICSEARCH_ENABLED=true
ELASTICSEARCH_AUTO_SYNC=true
ELASTICSEARCH_SYNC_INTERVAL=0 */2 * * *
ELASTICSEARCH_BATCH_SIZE=100

# For external connections (from host machine)
# ELASTICSEARCH_NODE=http://localhost:9200
# ELASTICSEARCH_URL=http://localhost:9200

# ============================================
# OAuth Configuration
# ============================================
# IMPORTANT: OAuth credentials are stored in DATABASE (system_settings table)
# They are encrypted using ENCRYPTION_KEY below
# You do NOT need to set GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET, etc. in this file
# 
# To configure OAuth:
# 1. Set ENCRYPTION_KEY below (required for decrypting credentials from DB)
# 2. Use Admin Panel to configure OAuth credentials in database
# 3. Credentials will be automatically loaded from database on startup
#
# For reference only (NOT USED if stored in database):
# GOOGLE_CLIENT_ID=stored_in_database
# GOOGLE_CLIENT_SECRET=stored_in_database
# FACEBOOK_APP_ID=stored_in_database
# FACEBOOK_APP_SECRET=stored_in_database

# ============================================
# Cloudflare Integration (Optional)
# ============================================
# Set to true if using Cloudflare Worker for OAuth
USE_CLOUDFLARE_OAUTH=false
CLOUDFLARE_WORKER_URL=https://phimgg.com

# Set to true if using Cloudflare for email service
USE_CLOUDFLARE_EMAIL=false

# ============================================
# Email Service Configuration
# ============================================
# IMPORTANT: Email API keys can be stored in DATABASE (system_settings table)
# If stored in database, they will be encrypted using ENCRYPTION_KEY
#
# Option 1: Store in database (recommended for production)
# - Use Admin Panel to set 'resend_api_key' in system_settings
# - Leave SENDGRID_API_KEY empty here
#
# Option 2: Set in environment (for development/testing)
SENDGRID_API_KEY=your_sendgrid_api_key_here
FROM_EMAIL=noreply@phimgg.com
FROM_NAME=PhimGG

# SMTP Configuration (Alternative to SendGrid)
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER=your_email@gmail.com
# SMTP_PASS=your_app_password

# ============================================
# Redis Configuration (Optional)
# ============================================
# Uncomment if using Redis for caching/sessions
# REDIS_URL=redis://localhost:6379
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=

# ============================================
# Firebase Push Notifications
# ============================================
# IMPORTANT: Firebase credentials can be stored in DATABASE (system_settings table)
# If stored in database, they will be encrypted using ENCRYPTION_KEY
# 
# To configure Firebase:
# 1. Use Admin Panel → Settings → Analytics & API Keys
# 2. Enter Project ID, Client Email, and Private Key
# 3. Enable Push Notifications
#
# Fallback environment variables (if not in database):
# FIREBASE_ADMIN_PROJECT_ID=your_project_id
# FIREBASE_ADMIN_CLIENT_EMAIL=your_client_email
# FIREBASE_ADMIN_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"

# ============================================
# Logging Configuration
# ============================================
LOG_LEVEL=info
LOG_DIR=/app/logs

# ============================================
# API Rate Limiting
# ============================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ============================================
# File Upload Configuration
# ============================================
MAX_FILE_SIZE=5242880
UPLOAD_DIR=/app/uploads

# ============================================
# Feature Flags
# ============================================
ENABLE_REGISTRATION=true
ENABLE_SOCIAL_LOGIN=true
ENABLE_EMAIL_VERIFICATION=true
ENABLE_ANALYTICS=true

# ============================================
# External API Configuration
# ============================================
# PhimAPI - Source for movie data
PHIM_API_BASE_URL=https://phimapi.com
PHIM_API_TIMEOUT=30000

# ============================================
# Monitoring & Analytics (Optional)
# ============================================
# SENTRY_DSN=your_sentry_dsn_here
# GOOGLE_ANALYTICS_ID=your_ga_id_here

# ============================================
# Backup Configuration
# ============================================
BACKUP_DIR=/var/backups/filmflex
BACKUP_RETENTION_DAYS=30

# ============================================
# Notes for Production Deployment
# ============================================
# 1. Update SESSION_SECRET with a strong random value
# 2. Update ENCRYPTION_KEY with a strong random value
# 3. Configure OAuth credentials (Google, Facebook)
# 4. Configure email service (SendGrid or SMTP)
# 5. Set up SSL certificates for HTTPS
# 6. Configure firewall rules
# 7. Set up automated backups
# 8. Configure monitoring and logging
# 9. Review and update CORS settings if needed
# 10. Test all features before going live